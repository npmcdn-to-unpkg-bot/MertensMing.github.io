---
title: Gulp 学习笔记 —— API
date: 2016-05-05 15:50:12
tags: [Gulp, 前端自动化]
---

**学习资料**

[gulp教程之gulp中文API](http://www.ydcss.com/archives/424)

# gulp.src 

```html 
gulp.src(globs[, options])
```

**src方法是指定需要处理的源文件的路径**

gulp借鉴了Unix操作系统的管道（pipe）思想，前一级的输出，直接变成后一级的输入，gulp.src返回当前文件流至可用插件；

## globs(必填)

**要处理的源文件匹配符路径。**

类型：`String` or `StringArray`；

路径匹配示例：

选择符 | 作用 | 例子
-- | -- | --
`src/a.js` | 指定具体文件 | `src/a.js` (包含src的 a.js)
`*` | 匹配所有文件 | `src/*.js` (包含src下的所有js文件)
`**` | 匹配0个或多个子文件夹 | `src/**/*.js` (包含src的0个或多个子文件夹下的js文件)
`{}` | 匹配多个属性 | `src/**/*.js` (包含src的0个或多个子文件夹下的js文件)
`!` | 排除文件 | `!src/a.js`(不包含src下的a.js文件)

```js 
var gulp = require('gulp'),
    less = require('gulp-less');
 
gulp.task('testLess', function () {
    //gulp.src('less/test/style.less')
    gulp.src(['less/**/*.less','!less/{extend,page}/*.less'])
        .pipe(less())
        .pipe(gulp.dest('./css'));
});
```

<!-- more -->

## options(可选)

类型：`Object`，有3个属性`buffer`、`read`、`base`；

属性名 | 类型 | 描述
-- | -- | --
`buffer` | Boolean | 默认：`true` 设置为`false`，将返回`file.content`的流并且不缓冲文件，处理大文件时非常有用
`read` | Boolean | 默认：`true` 设置`false`，将不执行读取文件操作，返回`null`
`base` | String | 设置输出路径以某个路径的某个组成部分为基础向后拼接

```js 
gulp.src('client/js/**/*.js') 
  .pipe(minify())
  .pipe(gulp.dest('build'));  // Writes 'build/somedir/somefile.js'
 
gulp.src('client/js/**/*.js', { base: 'client' })
  .pipe(minify())
  .pipe(gulp.dest('build'));  // Writes 'build/js/somedir/somefile.js'
```

# gulp.dest

```html 
gulp.dest(path[, options])
```

**`dest`方法是指定处理完后文件输出的路径**

```js 
gulp.src('./client/templates/*.jade')
  .pipe(jade())
  .pipe(gulp.dest('./build/templates'))
  .pipe(minify())
  .pipe(gulp.dest('./build/minified_templates'));
```

## path(必填)  

类型：`String` or `Function` 

**指定文件输出路径，或者定义函数返回文件输出路径亦可；**

## options(可选)

类型：`Object`，有2个属性`cwd`、`mode`；

属性名 | 类型 | 描述
-- | -- | --
`cwd` | String | 默认：`process.cwd()` 前脚本的工作目录的路径 当文件输出路径为相对路径将会用到
`read` | Boolean | 默认：`0777` 指定被创建文件夹的权限

# gulp.task

```html 
gulp.task(name[, deps], fn)
```

task定义一个gulp任务

## name(必填)  

类型：String 

**指定任务的名称（不应该有空格）**

## deps(可选)  

类型：StringArray

该任务依赖的任务（注意：**被依赖的任务需要返回当前任务的事件流**）

## fn(必填)  

类型：Function 

**该任务调用的插件操作**

```js 
gulp.task('testLess', function () {
    return gulp.src(['less/style.less'])
        .pipe(less())
        .pipe(gulp.dest('./css'));
});
 
gulp.task('minicss', ['testLess'], function () { //执行完testLess任务后再执行minicss任务
    gulp.src(['css/*.css'])
        .pipe(minifyCss())
        .pipe(gulp.dest('./dist/css'));
});
```

# gulp.watch

```html 
gulp.watch(glob [, opts], tasks)

gulp.watch(glob [, opts, callback])
```

**watch方法是用于监听文件变化，文件一修改就会执行指定的任务**

## glob(必填)  

类型：String or StringArray

**需要处理的源文件匹配符路径**

## opts(可选)  

类型：Object 

**具体参看[这里](https://github.com/shama/gaze)**

## tasks(必填)  

类型：StringArray 

**需要执行的任务的名称数组**

## callback(event)(可选)

类型：Function 

**每个文件变化执行的回调函数**

```js
gulp.task('watch1', function () {
    gulp.watch('less/**/*.less', ['testLess']);
});
 
gulp.task('watch2', function () {
    gulp.watch('js/**/*.js', function (event) {
        console.log('File ' + event.path + ' was ' + event.type + ', running tasks...');
    });
});
```
