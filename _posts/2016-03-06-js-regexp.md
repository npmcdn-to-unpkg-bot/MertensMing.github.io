---
title: JS 中的正则表达式
date: 2016-03-06 22:05:33
categories: JavaScript
tags: 正则表达式
---
## RegExp对象
### 正则对象实例的属性

- `global`（是否带有修饰符 `g` 的布尔值）
- `ignoreCase`（是否带有修饰符 `i` 的布尔值）
- `lastIndex`（对象方法匹配开始的位置索引，初始为 0）
- `multiline`（是否带有修饰符 `m` 的布尔值）
- `source`（正则源码文本,注意源码文本不包括修饰符）

> `ES6` 中 `RegExp` 对象实例新增的只读属性 `sticky` 可以判断正则后是否带修饰符 `y` （新增），设置 `y` 修饰符的正则每次匹配，存在 `lastIndex` 属性情况下 `lastIndex` 不会自动归零，并且在正则表达式中隐式地加入了开头元字符 `^`，这样就使得正则表达式的匹配锚定在 `lastIndex` 的位置。

<!--more-->

### 正则对象实例的方法
#### `exec()` 
- 匹配失败返回 `null`，匹配成功它将返回一个数组， 数组第一个元素是匹配整个正则的内容，之后的元素是正则中捕获组的匹配

```javascript
//捕获组()
var pattern1 = /(www)\.(baidu)\.(com)/i  
//非捕获组(?:)
var pattern2 = /(?:www)\.(?:baidu)\.(?:com)/i

var str  = 'www.baidu.com'

pattern1.exec(str)
//返回数组["www.baidu.com", "www", "baidu", "com"]
pattern2.exec(str)
//返回数组["www.baidu.com"]
```

#### `test()`
- 匹配成功返回 true，失败返回 false。

#### `lastIndex`
- 这里需要注意下这两个方法中的 `lastIndex` 属性与正则表达式中的全局修饰符 `g` 的关系，当正则中存在全局修饰符 `g` 时，`RegExp` 对象的 `lastIndex` 属性将保存下一次开始的匹配的位置

```javascript
var  pattern = /(www)\.(baidu)\.(com)/g 
var  str2 = 'www.baidu.com www.google.com www.baidu.com'
pattern.exec(str2)
console.log(pattern.lastIndex);  //13
console.log(pattern.test(str2)); //false
```

## String中的正则方法

### `match()`
- `match()` 方法接受一个字符串或正则作为参数，当参数是正则时， 正则是否带全局修饰符 `g` 将影响该方法的返回值，该方法匹配不带全局修饰符的正则时，与 `RegExp` 对象实例方法 `exec()` 的返回值一样， 匹配带全局修饰符的正则时，`match()` 方法将返回全局中所匹配到的所有内容而不再将正则中的捕获组编码。比如前面的 `str2` 如果使用 `String` 的 `match` 方法的话其返回的数组中将是 `["www.baidu.com"，"www.baidu.com"］`。

### `replace()`
- `replace(searchValue,replaceValue)` 方法同样接受字符串或正则作为第一个参数，当搜索值是字符串的时候，它只会匹配一次，很多时候这并非我们要的结果， 一般我们希望全局匹配，于是可以使用带全局修饰符的正则表达式。`replace()` 的替换值中的美元符号 `$` 有特殊含义，比如 `$1` 表示正则表达式中第一个捕获组的匹配内容。它的意义取自RegExp构造函数的属性（正则表达式每次的操作都会影响构造函数 `RegExp` 的属性，该构造函数属性的详细参考可以看下《JS高级程序设计》中文第三版108页中的说明）下面借用《JS权威指南》核心参考中的栗子。

#### 美元符号的特殊含义归纳：
- $$ 替换对象$
- $& 整个匹配的文本
- $number 分组捕获的文本(从1开始，不是0哦)
- $` 匹配之前的文本
- $' 匹配之后的文本

### `search()`
`search()` 方法与 `String` 中 `indexOf` 类似，接受一个正则或者字符串为参数，匹配成功返回第一个匹配的首字符位置， 失败则返回 `-1`。

### `split()`
- `split(separator,howmany)` 方法接受一个必选的分割位置作为第一个参数，第二个参数设置返回数组的最大长度。第一个参数可以是字符串或正则表达式，**如果该参数是包含捕获组**(带圆括号带子表达式)的正则表达式，那么返回的数组中包括与这些子表达式匹配的字串（但不包括与整个正则表达式匹配的文本）
- 可以看到捕获组中的匹配 `("o")` 也在返回的数组中，但是整个正则的匹配被作为分隔位置。并非所有浏览器都支持 `split()` 这个特性。

```javascript
'hello world'.split(/(\w)\s/)
//返回["hell", "o", "world"]
```

## JS中不支持的正则特性

- 匹配字符串开始的结尾的\A和\Z锚(但支持以^和$来匹配字符串的开始的结尾)
- 向后查找(但支持向前查找)
- 并集和交集类
- 原子组
- Unicode支持(单个字符除外)
- 命名的捕获组(但支持编号的捕获组)
- s(single单行)和x(free-spacing无间隔)匹配模式
- 条件匹配
- 正则表达式注释


**参考** 
[正则与JS中的正则](http://segmentfault.com/a/1190000004106110)